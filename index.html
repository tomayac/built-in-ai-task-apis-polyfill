<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ§ </text></svg>"
    />
    <style>
      body {
        white-space: pre-wrap;
      }
    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Built-in AI task APIs polyfill</title>
  </head>
  <body>
    <script type="module" src="/src/install.js"></script>
    <script type="module">
      import { configureFirebaseBackend } from './src/backends/firebase/index.js';
      configureFirebaseBackend();

      (async () => {
        const text = `Thomas Steiner is a Developer Relations Engineer at Google, focused on Web AI, WebAssembly, and Project Fugu. He's an alumnus of University of Lyon (Postdoc), Polytechnic University of Barcelona (Ph. D.), and University of Karlsruhe (MA).
				
He blogs at blog.tomayac.com and posts as @tomayac@toot.cafe. On all other places on the Internet, chances are that he's there under his online alias tomayac.`;
        document.body.textContent = '# Built-in AI task APIs polyfill\n\n';
        document.body.append('## Original text\n\n');
        document.body.append(text);
        document.body.append('\n\n');

        document.body.append('## Summarizer availability\n\n');
        document.body.append(await Summarizer.availability());
        document.body.append('\n\n');

        const summarizer = await Summarizer.create({
          sharedContext: 'This is a short biography of a conference speaker.',
          expectedInputLanguages: ['en'],
          expectedContextLanguages: ['en'],
          outputLanguage: 'en',
          format: 'markdown',
          type: 'key-points',
          length: 'short',
        });

        document.body.append('## Summarizer non-streaming summary\n\n');
        document.body.append(await summarizer.summarize(text));
        document.body.append('\n\n');

        document.body.append('## Summarizer streaming summary\n\n');
        const stream = summarizer.summarizeStreaming(text);
        for await (const chunk of stream) {
          document.body.append(chunk);
        }
        document.body.append('\n\n');

        document.body.append('## Summarizer measure input usage\n\n');
        document.body.append(String(await summarizer.measureInputUsage(text)));
        document.body.append('\n\n');

        document.body.append('## Writer availability\n\n');
        document.body.append(await Writer.availability());
        document.body.append('\n\n');

        const writer = await Writer.create({
          sharedContext: 'This is a biography of a conference speaker.',
          expectedInputLanguages: ['en'],
          expectedContextLanguages: ['en'],
          outputLanguage: 'en',
          format: 'plain-text',
          tone: 'formal',
          length: 'medium',
        });

        document.body.append('## Writer non-streaming write\n\n');
        document.body.append(
          await writer.write(
            'Write a short biography about Thomas, based on the text:\n\n' +
              text
          )
        );
        document.body.append('\n\n');

        document.body.append('## Writer streaming write\n\n');
        const writerStream = writer.writeStreaming(
          'Write a biography about Thomas, based on the text:\n\n' + text
        );
        for await (const chunk of writerStream) {
          document.body.append(chunk);
        }

        document.body.append('\n\n');
        document.body.append('## Writer measure input usage\n\n');
        document.body.append(String(await writer.measureInputUsage(text)));
        document.body.append('\n\n');

        document.body.append('## Rewriter availability\n\n');
        document.body.append(await Rewriter.availability());
        document.body.append('\n\n');

        const rewriter = await Rewriter.create({
          sharedContext: 'This is a biography of a conference speaker.',
          expectedInputLanguages: ['en'],
          expectedContextLanguages: ['en'],
          outputLanguage: 'en',
          format: 'plain-text',
          tone: 'more-formal',
          length: 'longer',
        });

        document.body.append('## Rewriter non-streaming rewrite\n\n');
        document.body.append(
          await rewriter.rewrite(
            'Rewrite a short biography about Thomas, based on the text:\n\n' +
              text
          )
        );
        document.body.append('\n\n');

        document.body.append('## Rewriter streaming rewrite\n\n');
        const rewriterStream = rewriter.rewriteStreaming(
          'Rewrite a biography about Thomas, based on the text:\n\n' + text
        );
        for await (const chunk of rewriterStream) {
          document.body.append(chunk);
        }

        document.body.append('\n\n');
        document.body.append('## Rewriter measure input usage\n\n');
        document.body.append(String(await rewriter.measureInputUsage(text)));
        document.body.append('\n\n');
      })();
    </script>
  </body>
</html>
